<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>SkyNet: /home/michi/projects/SkyNet-Dongle/firmware/src/usb/skynet_cdc.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SkyNet
   &#160;<span id="projectnumber">3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('skynet__cdc_8c.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">skynet_cdc.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="skynet__cdc_8h_source.html">skynet_cdc.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af94a782f743da6321562c732c4eee8dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#af94a782f743da6321562c732c4eee8dc">skynet_cdc_init</a> (void)</td></tr>
<tr class="memdesc:af94a782f743da6321562c732c4eee8dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the USB driver as a USB CDC virtual com port device (client).  <a href="#af94a782f743da6321562c732c4eee8dc">More...</a><br /></td></tr>
<tr class="separator:af94a782f743da6321562c732c4eee8dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4144208938d5edf8abab26079c42a762"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a4144208938d5edf8abab26079c42a762">skynet_cdc_connect</a> (void)</td></tr>
<tr class="memdesc:a4144208938d5edf8abab26079c42a762"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes connection to USB host.  <a href="#a4144208938d5edf8abab26079c42a762">More...</a><br /></td></tr>
<tr class="separator:a4144208938d5edf8abab26079c42a762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adef0533504ae89a3c43a85f570c6f356"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#adef0533504ae89a3c43a85f570c6f356">skynet_cdc_disconnect</a> (void)</td></tr>
<tr class="memdesc:adef0533504ae89a3c43a85f570c6f356"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shuts the connection to USB host down.  <a href="#adef0533504ae89a3c43a85f570c6f356">More...</a><br /></td></tr>
<tr class="separator:adef0533504ae89a3c43a85f570c6f356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fbd54f7ff4b48c5b9a900421adf3702"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a0fbd54f7ff4b48c5b9a900421adf3702">USB_IRQHandler</a> (void)</td></tr>
<tr class="memdesc:a0fbd54f7ff4b48c5b9a900421adf3702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle interrupt from USB0.  <a href="#a0fbd54f7ff4b48c5b9a900421adf3702">More...</a><br /></td></tr>
<tr class="separator:a0fbd54f7ff4b48c5b9a900421adf3702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9b1f39e2a05abac3136ac95a734fce4"><td class="memItemLeft" align="right" valign="top">USB_INTERFACE_DESCRIPTOR *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#ab9b1f39e2a05abac3136ac95a734fce4">find_IntfDesc</a> (const uint8_t *pDesc, uint32_t intfClass)</td></tr>
<tr class="memdesc:ab9b1f39e2a05abac3136ac95a734fce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the address of interface descriptor for given class type.  <a href="#ab9b1f39e2a05abac3136ac95a734fce4">More...</a><br /></td></tr>
<tr class="separator:ab9b1f39e2a05abac3136ac95a734fce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7ac98994ceeda3e9f580da9fe41d03b"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#ac7ac98994ceeda3e9f580da9fe41d03b">skynet_cdc_read</a> (uint8_t *pBuf, uint32_t buf_len)</td></tr>
<tr class="memdesc:ac7ac98994ceeda3e9f580da9fe41d03b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads non-blocking all available characters into pBuf.  <a href="#ac7ac98994ceeda3e9f580da9fe41d03b">More...</a><br /></td></tr>
<tr class="separator:ac7ac98994ceeda3e9f580da9fe41d03b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d362abf2b153e7f343abb3547953ceb"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a6d362abf2b153e7f343abb3547953ceb">skynet_cdc_write</a> (uint8_t *pBuf, uint32_t len)</td></tr>
<tr class="memdesc:a6d362abf2b153e7f343abb3547953ceb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends len characters from pBuf to usb host.  <a href="#a6d362abf2b153e7f343abb3547953ceb">More...</a><br /></td></tr>
<tr class="separator:a6d362abf2b153e7f343abb3547953ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad1616699fbd947a5445e630b0728b37"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#aad1616699fbd947a5445e630b0728b37">skynet_cdc_write_buffered</a> (uint8_t *pBuf, uint32_t len)</td></tr>
<tr class="memdesc:aad1616699fbd947a5445e630b0728b37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes len characters from pBuf into sending buffer.  <a href="#aad1616699fbd947a5445e630b0728b37">More...</a><br /></td></tr>
<tr class="separator:aad1616699fbd947a5445e630b0728b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee86055644b9899f0a364ca1c4e8eebe"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#aee86055644b9899f0a364ca1c4e8eebe">skynet_cdc_flush</a> (void)</td></tr>
<tr class="memdesc:aee86055644b9899f0a364ca1c4e8eebe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the bytes in the buffer immediately.  <a href="#aee86055644b9899f0a364ca1c4e8eebe">More...</a><br /></td></tr>
<tr class="separator:aee86055644b9899f0a364ca1c4e8eebe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a775eaea71b3636370920e8fbe798d86f"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a775eaea71b3636370920e8fbe798d86f">skynet_cdc_write_message</a> (<a class="el" href="structusb__message.html">usb_message</a> *msg)</td></tr>
<tr class="memdesc:a775eaea71b3636370920e8fbe798d86f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a <a class="el" href="structusb__message.html">usb_message</a> to usb host.  <a href="#a775eaea71b3636370920e8fbe798d86f">More...</a><br /></td></tr>
<tr class="separator:a775eaea71b3636370920e8fbe798d86f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5e6af4407dde47f239ddf3b0c62ff4"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a7b5e6af4407dde47f239ddf3b0c62ff4">skynet_cdc_write_debug</a> (const char *format,...)</td></tr>
<tr class="memdesc:a7b5e6af4407dde47f239ddf3b0c62ff4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Works like to printf and generates debug output message.  <a href="#a7b5e6af4407dde47f239ddf3b0c62ff4">More...</a><br /></td></tr>
<tr class="separator:a7b5e6af4407dde47f239ddf3b0c62ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a759ffef08d6d690b639df232251143e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a759ffef08d6d690b639df232251143e7">skynet_cdc_receive_data</a> (void)</td></tr>
<tr class="memdesc:a759ffef08d6d690b639df232251143e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Must be called if usb characters are available.  <a href="#a759ffef08d6d690b639df232251143e7">More...</a><br /></td></tr>
<tr class="separator:a759ffef08d6d690b639df232251143e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6dedf4a94bfaacb370622476b90be0f2"><td class="memItemLeft" align="right" valign="top">const USBD_HW_API_T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a6dedf4a94bfaacb370622476b90be0f2">hw_api</a></td></tr>
<tr class="separator:a6dedf4a94bfaacb370622476b90be0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c48edecd9da4dbd49d0a1dd6195455c"><td class="memItemLeft" align="right" valign="top">const USBD_CORE_API_T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a5c48edecd9da4dbd49d0a1dd6195455c">core_api</a></td></tr>
<tr class="separator:a5c48edecd9da4dbd49d0a1dd6195455c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a504b11be35ba5820bda17c430f10a4bd"><td class="memItemLeft" align="right" valign="top">const USBD_CDC_API_T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a504b11be35ba5820bda17c430f10a4bd">cdc_api</a></td></tr>
<tr class="separator:a504b11be35ba5820bda17c430f10a4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa694a4a7a106972c3e4bd17e03ab8f3b"><td class="memItemLeft" align="right" valign="top">const USBD_API_T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#aa694a4a7a106972c3e4bd17e03ab8f3b">g_pUsbApi</a> = &amp;g_usbApi</td></tr>
<tr class="separator:aa694a4a7a106972c3e4bd17e03ab8f3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a809d1b3c77968dbfa91dea822b8a7"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a34a809d1b3c77968dbfa91dea822b8a7">current_seqno</a> = 0</td></tr>
<tr class="separator:a34a809d1b3c77968dbfa91dea822b8a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd23d177a91eb34d3f46a7a44d64bb1c"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#abd23d177a91eb34d3f46a7a44d64bb1c">usb_cdc_write_buf</a> [<a class="el" href="message_8h.html#a573d2f5fe7b80ffe399033fe93af6363">USB_MAX_MESSAGE_LENGTH</a>]</td></tr>
<tr class="separator:abd23d177a91eb34d3f46a7a44d64bb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dd77c18c5fc4d5c483c08bd25e9d21d"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a3dd77c18c5fc4d5c483c08bd25e9d21d">usb_cdc_write_pos</a> = 0</td></tr>
<tr class="separator:a3dd77c18c5fc4d5c483c08bd25e9d21d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac13212b871967000883850b61996a823"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#ac13212b871967000883850b61996a823">usb_payload_buf</a> [<a class="el" href="message_8h.html#abf8fb7071ddd2ae8e546952f02548cba">USB_MAX_PAYLOAD_LENGTH</a>]</td></tr>
<tr class="separator:ac13212b871967000883850b61996a823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6fded26022fa481f58bc474cfd0b190"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#ab6fded26022fa481f58bc474cfd0b190">usb_read_pos</a> = 0</td></tr>
<tr class="separator:ab6fded26022fa481f58bc474cfd0b190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab61681c7fbefa733eefb65083774569f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#ab61681c7fbefa733eefb65083774569f">usb_reverse</a> = false</td></tr>
<tr class="separator:ab61681c7fbefa733eefb65083774569f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a888b90899c7b862fc9a31d4aa8f88b01"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structusb__message.html">usb_message</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a888b90899c7b862fc9a31d4aa8f88b01">usb_received_message</a></td></tr>
<tr class="separator:a888b90899c7b862fc9a31d4aa8f88b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3198a9cdd5465911e75ff41c47635444"><td class="memItemLeft" align="right" valign="top"><a class="el" href="skynet__cdc_8h.html#a269061fc623fdacbe291937af63a308d">usb_receive_state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="skynet__cdc_8c.html#a3198a9cdd5465911e75ff41c47635444">usb_rx_state</a> = <a class="el" href="skynet__cdc_8h.html#a269061fc623fdacbe291937af63a308da55ac62549714de4d26627ef6ba3a280f">USB_RECEIVE_IDLE</a></td></tr>
<tr class="separator:a3198a9cdd5465911e75ff41c47635444"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>25.10.2015 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Michael Zapf <a href="#" onclick="location.href='mai'+'lto:'+'mic'+'ha'+'el.'+'za'+'pf@'+'fa'+'u.d'+'e'; return false;">micha<span style="display: none;">.nosp@m.</span>el.z<span style="display: none;">.nosp@m.</span>apf@f<span style="display: none;">.nosp@m.</span>au.d<span style="display: none;">.nosp@m.</span>e</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>This file is mostly based on example code from NXP Semiconductors. The code is used under the following license:</dd></dl>
<p>Copyright(C) NXP Semiconductors, 2013 All rights reserved.</p>
<dl class="section user"><dt></dt><dd>Software that is described herein is for illustrative purposes only which provides customers with programming information regarding the LPC products. This software is supplied "AS IS" without any warranties of any kind, and NXP Semiconductors and its licensor disclaim any and all warranties, express or implied, including all implied warranties of merchantability, fitness for a particular purpose and non-infringement of intellectual property rights. NXP Semiconductors assumes no responsibility or liability for the use of the software, conveys no license or rights under any patent, copyright, mask work right, or any other intellectual property rights in or to any products. NXP Semiconductors reserves the right to make changes in the software without notification. NXP Semiconductors also makes no representation or warranty that such application will be suitable for the specified use without further testing or modification.</dd></dl>
<dl class="section user"><dt></dt><dd>Permission to use, copy, modify, and distribute this software and its documentation is hereby granted, under NXP Semiconductors' and its licensor's relevant copyrights in the software, without fee, provided that it is used in conjunction with NXP Semiconductors microcontrollers. This copyright, permission, and disclaimer notice must appear in all copies of this code. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab9b1f39e2a05abac3136ac95a734fce4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">USB_INTERFACE_DESCRIPTOR* find_IntfDesc </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>intfClass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the address of interface descriptor for given class type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pDesc</td><td>: Pointer to configuration descriptor in which the desired class interface descriptor to be found. </td></tr>
    <tr><td class="paramname">intfClass</td><td>: Interface class type to be searched. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If found returns the address of requested interface else returns NULL. </dd></dl>

</div>
</div>
<a class="anchor" id="a4144208938d5edf8abab26079c42a762"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void skynet_cdc_connect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes connection to USB host. </p>
<p>This has fairly the same effect as plugging the cable in. This function is called by <a class="el" href="skynet__cdc_8c.html#af94a782f743da6321562c732c4eee8dc">skynet_cdc_init()</a> automatically.</p>
<p>After this function was called the host can start the enumeration process.</p>
<dl class="section note"><dt>Note</dt><dd>This function does not block until host accepts connection. </dd></dl>

</div>
</div>
<a class="anchor" id="adef0533504ae89a3c43a85f570c6f356"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void skynet_cdc_disconnect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shuts the connection to USB host down. </p>
<p>This has fairly the same effect as plugging the cable out. </p>

</div>
</div>
<a class="anchor" id="aee86055644b9899f0a364ca1c4e8eebe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t skynet_cdc_flush </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send the bytes in the buffer immediately. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of written bytes. </dd></dl>

</div>
</div>
<a class="anchor" id="af94a782f743da6321562c732c4eee8dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int skynet_cdc_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the USB driver as a USB CDC virtual com port device (client). </p>
<p>This also calls <a class="el" href="skynet__cdc_8c.html#a4144208938d5edf8abab26079c42a762">skynet_cdc_connect()</a> after a successful setup procedure.</p>
<dl class="section return"><dt>Returns</dt><dd><b>0</b> in case of an error, any other number means <b>success</b>. </dd></dl>

</div>
</div>
<a class="anchor" id="ac7ac98994ceeda3e9f580da9fe41d03b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t skynet_cdc_read </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>buf_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads non-blocking all available characters into pBuf. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of read bytes. </dd></dl>

</div>
</div>
<a class="anchor" id="a759ffef08d6d690b639df232251143e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void skynet_cdc_receive_data </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Must be called if usb characters are available. </p>
<p>Then they are processed. </p>

</div>
</div>
<a class="anchor" id="a6d362abf2b153e7f343abb3547953ceb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t skynet_cdc_write </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends len characters from pBuf to usb host. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of written bytes. </dd></dl>

</div>
</div>
<a class="anchor" id="aad1616699fbd947a5445e630b0728b37"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t skynet_cdc_write_buffered </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes len characters from pBuf into sending buffer. </p>
<p>Bytes won't be sent until buffer is full or <a class="el" href="skynet__cdc_8c.html#aee86055644b9899f0a364ca1c4e8eebe">skynet_cdc_flush()</a> is called.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of written bytes. </dd></dl>

</div>
</div>
<a class="anchor" id="a7b5e6af4407dde47f239ddf3b0c62ff4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t skynet_cdc_write_debug </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Works like to printf and generates debug output message. </p>
<p>Internally it uses vsnprintf to stay in maximum message size. </p>

</div>
</div>
<a class="anchor" id="a775eaea71b3636370920e8fbe798d86f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t skynet_cdc_write_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structusb__message.html">usb_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a <a class="el" href="structusb__message.html">usb_message</a> to usb host. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of written bytes. </dd></dl>

</div>
</div>
<a class="anchor" id="a0fbd54f7ff4b48c5b9a900421adf3702"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void USB_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle interrupt from USB0. </p>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a504b11be35ba5820bda17c430f10a4bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const USBD_CDC_API_T cdc_api</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5c48edecd9da4dbd49d0a1dd6195455c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const USBD_CORE_API_T core_api</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a34a809d1b3c77968dbfa91dea822b8a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t current_seqno = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa694a4a7a106972c3e4bd17e03ab8f3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const USBD_API_T* g_pUsbApi = &amp;g_usbApi</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6dedf4a94bfaacb370622476b90be0f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const USBD_HW_API_T hw_api</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abd23d177a91eb34d3f46a7a44d64bb1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char usb_cdc_write_buf[<a class="el" href="message_8h.html#a573d2f5fe7b80ffe399033fe93af6363">USB_MAX_MESSAGE_LENGTH</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3dd77c18c5fc4d5c483c08bd25e9d21d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int usb_cdc_write_pos = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac13212b871967000883850b61996a823"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char usb_payload_buf[<a class="el" href="message_8h.html#abf8fb7071ddd2ae8e546952f02548cba">USB_MAX_PAYLOAD_LENGTH</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab6fded26022fa481f58bc474cfd0b190"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int usb_read_pos = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a888b90899c7b862fc9a31d4aa8f88b01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structusb__message.html">usb_message</a> usb_received_message</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab61681c7fbefa733eefb65083774569f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool usb_reverse = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3198a9cdd5465911e75ff41c47635444"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="skynet__cdc_8h.html#a269061fc623fdacbe291937af63a308d">usb_receive_state</a> usb_rx_state = <a class="el" href="skynet__cdc_8h.html#a269061fc623fdacbe291937af63a308da55ac62549714de4d26627ef6ba3a280f">USB_RECEIVE_IDLE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_74712b2155551d19e5fc375f21fbf06e.html">usb</a></li><li class="navelem"><a class="el" href="skynet__cdc_8c.html">skynet_cdc.c</a></li>
    <li class="footer">Generated on Sun Dec 6 2015 17:08:42 for SkyNet by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
